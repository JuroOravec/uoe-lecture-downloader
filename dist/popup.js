!function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=9)}([,,function(e,n){e.exports='<label class="size-option select-option" tabindex="0" role="checkbox">\n    <input type="checkbox" value="${format}" name="size-select" tabindex="-1">\n    <div>\n        <span>${format}</span>\n    </div>\n</label>'},function(e,n){e.exports='<label class="option" tabindex="0">\n    <input type="checkbox" class="size-${format}" name="${nameEscaped}-${format}" data-format="${format}"\n        data-size="${size}" data-url="${s3Url}">\n    <div>\n        <span>${format}</span>\n    </div>\n</label>'},function(e,n){e.exports='<div class="lecture ${seenState}">\n    <div class="seen-state">\n        <span>${seenState}</span>\n    </div>\n    <a href="${thumbnailLink}" title="${name}" target="_blank" tabindex="0">\n        <img class="lecture-thumbnail" src="${thumbnailUrl}" alt="${name}">\n    </a>\n    <div class="lecture-desc">\n        <h3 class="lecture-title">${name}</h3>\n        <div class="download-options">\n        </div>\n        <div class="download">\n            <button class="download-btn" disabled tabindex="0">\n                <span>DOWNLOAD</span>\n                <span class="download-size" data-size="0"></span>\n            </button>\n        </div>\n    </div>\n</div>\n<hr>'},function(e,n){e.exports='<div class="course" id="course-${courseId}">\n    <div class="course-title-container">\n        <h3 class="course-title">${courseName}</h3>\n    </div>\n    <hr>\n    <div class="course-select">\n        <span>\n            <span class="lecture-count"></span> Lectures</span>\n        <div class="select-wrap select-by-format" role="checkboxgroup">\n        </div>\n        <div class="select-wrap select-by-seen" role="radiogroup">\n            <label class="group-option select-option" tabindex="0" role="radio">\n                <input type="radio" value="all" name="group-select-${courseId}" tabindex="-1" checked>\n                <div>\n                    <span>All</span>\n                </div>\n            </label>\n            <label class="group-option select-option" tabindex="0" role="radio">\n                <input type="radio" value="seen" name="group-select-${courseId}" tabindex="-1">\n                <div>\n                    <span>Seen</span>\n                </div>\n            </label>\n            <label class="group-option select-option" tabindex="0" role="radio">\n                <input type="radio" value="unseen" name="group-select-${courseId}" tabindex="-1">\n                <div>\n                    <span>Unseen</span>\n                </div>\n            </label>\n        </div>\n    </div>\n    <hr>\n    <div class="lectures">\n    </div>\n</div>'},function(e,n){e.exports='<div class="popup">\n    <div class="courses"></div>\n    <div class="download-all">\n        <button class="download-all-btn" tabindex="0" disabled>\n            <span>DOWNLOAD ALL</span>\n            <span class="download-all-size"></span>\n        </button>\n    </div>\n</div>'},,function(e,n,t){},function(e,n,t){"use strict";var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=t(8);(r=c)&&r.__esModule;function a(e,n,t,r){if(e&&n&&t){0===r.length?(n.disabled=!0,e.classList.remove("active")):(n.disabled=!1,e.classList.add("active"));var o=Array.from(r).reduce(function(e,n){var t=Number(n.dataset.size);return e+(t=!0===Number.isNaN(t)?0:t)},0);t.dataset.size=o,t.innerHTML=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;if(Number.isNaN(Number(e)))return NaN;if(0===e)return"";var r=n?1e3:1024;if(Math.abs(e)<r)return e+" B";var o=n?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],c=-1;do{e/=r,++c}while(Math.abs(e)>=r&&c<o.length-1);return e.toFixed(t)+" "+o[c]}(o,!0)}else console.error("Could not update download size, one or more of necessary elements are missing.")}function l(e,n,t,r){Array.isArray(n)||(n=[n]);var o=n.map(function(e){return".lecture"+String(t)+' .download-options input[type="checkbox"].size-'+String(e)}).join(", ");e.querySelectorAll(o).forEach(function(e){if(e.checked!==r){var n=new Event("change");e.checked=r,e.dispatchEvent(n)}})}function s(e,n,t,r){if(e.preventDefault(),"keypress"!==e.type||13===e.keyCode){var o=n.checked;if(n.checked=r(n.checked),n.checked!==o){var c=n.closest(".course"),a=void 0;if(n.closest(".select-by-seen"))a=n.value;else{var s=c.querySelector(".select-by-seen input:checked");a=s?s.value:"all"}var i=[];n.closest(".select-by-format")?i.push(n.value):i=Array.from(c.querySelectorAll(".select-by-format input:checked")).map(function(e){return e.value});var u,d,f=[d="all"!==(u=a)&&""!==u?"."+String(u):"",""!==d?":not("+d+")":""];l(c,i,f[0],n.checked),""!==f[1]&&l(c,i,f[1],!1)}}}function i(e,n){if(Array.isArray(n)||(n=[n]),("keypress"!==e.type||13===e.keyCode)&&0!==n.length){var t=[];n.forEach(function(e,n){var r=e.closest(".lecture-desc");if(r){var o=e.closest(".course"),c=o?o.querySelector(".course-title"):null,a=c?c.innerHTML:"Other Courses",l=r.querySelector(".lecture-title"),s=l?l.innerHTML:"Lecture "+String(n+1),i=r.querySelectorAll('input[type="checkbox"]:checked');Array.from(i).forEach(function(e){e.dataset.size;var n=e.dataset.format,r=e.dataset.url,o=r.match(/(\.[^.]*?)((?=\?)|$)/)[1],c={url:r,filename:a+"/"+s+"-"+n+o,saveAs:!1};t.push(c)})}else console.error('Failed to get data for download: Could not find ".lecture-desc" ancestor element.')});var r={status:t.length>0?"success":"fail",from:"popup",to:"background",payload:{downloadQueryList:t}},o=JSON.stringify(r);chrome.runtime.sendMessage(o)}}function u(e,n){if("object"!==(void 0===n?"undefined":o(n)))throw TypeError("Expected argument to be object, got "+(void 0===n?"undefined":o(n)));var t=e.match(/\${.*?}/g),r=e;return(t=t.filter(function(e,n,t){return t.indexOf(e)===n})).forEach(function(e){var t=e.replace(/\${(.*?)}/,"$1");void 0===n[t]&&(n[t]="");var o=new RegExp("\\${"+t+"}","g");r=r.replace(o,n[t])}),r}setTimeout(function(){document.body.insertAdjacentHTML("beforeend",t(6)),chrome.storage.local.get("videos",function(e){e.videos.forEach(function(e){e.courseName=""===e.courseName?"Other":e.courseName,""==e.courseId&&(e.courseId=e.courseName.toLowerCase().replace(/ /g,"-").replace(/^-*/g,"").replace(/[^A-Za-z0-9_-]/g,""));var n=document.querySelector("#course-"+String(e.courseId));if(!n){var r=t(5),o=document.querySelector(".courses");o.insertAdjacentHTML("beforeend",u(r,e)),n=o.querySelector("#course-"+String(e.courseId))}var c=n.querySelector(".lectures"),a=t(4);c.insertAdjacentHTML("beforeend",u(a,e));var l=c.querySelectorAll(".lecture"),s=l[l.length-1],i=s.querySelector("a");i.innerHTML=i.innerHTML.trim();var d=s.querySelector(".download-options"),f=t(3),p=e.name.toLowerCase().replace(/ /g,"-"),v=Array.from(n.querySelectorAll(".size-option input")).map(function(e){return e.value}),y=n.querySelector(".select-by-format"),b=t(2);e.files.forEach(function(e){e.isAudio?e.format=e.s3Url.match(/\.([^.]*?)((?=\?)|$)/)[1]:e.format=Math.min(e.width,e.height).toString()+"p",e.nameEscaped=p,d.insertAdjacentHTML("beforeend",u(f,e)),y&&!v.includes(e.format)&&(y.insertAdjacentHTML("beforeend",u(b,e)),v.push(e.format))});var m=n.querySelector(".lecture-count");if(m){var h=n.querySelectorAll(".lecture").length.toString();m.innerHTML=h}}),document.querySelectorAll(".course").forEach(function(e){if(0===Array.from(e.querySelectorAll(".seen-state span")).filter(function(e){return""!==e.innerText}).length){var n=e.querySelector(".select-by-seen");n.style.width=n.offsetWidth+"px",n.innerHTML=""}});var n=document.querySelector(".download-all"),r=n.querySelector(".download-all-btn"),o=r.querySelector(".download-all-size");document.querySelectorAll(".option, .option input").forEach(function(e){var t="INPUT"!==e.nodeName?e.querySelector("input"):e,c=t.closest(".lecture").querySelector(".download"),l=c.querySelector(".download-btn"),s=c.querySelector(".download-size"),i=function(i){if("keypress"!==i.type||13===i.keyCode){"keypress"===i.type&&13==i.keyCode&&"INPUT"!==e.nodeName&&(t.checked=!t.checked);var u=t.closest(".lecture").querySelectorAll('input[type="checkbox"]:checked');a(c,l,s,u);var d=document.querySelectorAll(".download-btn:enabled .download-size");a(n,r,o,d),function(e){var n=e.closest(".course"),t=n.querySelector('.select-by-seen input[type="radio"]:checked'),r=t?t.value:"all",o="all"!==r&&""!==r?"."+String(r):"",c=e.dataset.format,a=n.querySelector('.course-select .select-by-format input[value="'+String(c)+'"]');if(!1===e.checked)a.checked=!e.closest(".lecture"+o)&&a.checked;else if(!0===e.checked){var l=n.querySelectorAll(".lecture"+o+' .download-options input[type="checkbox"].size-'+String(c)),s=Array.from(l).filter(function(e){return!e.checked});l.length>0&&0===s.length&&(a.checked=!a.checked||a.checked)}}(t)}};e.addEventListener("click",i),e.addEventListener("keypress",i),e.addEventListener("change",i)}),document.querySelectorAll(".course-select .select-by-seen label").forEach(function(e){var n="INPUT"!==e.nodeName?e.querySelector('input[type="radio"]'):e,t=function(e){return e||!0};e.addEventListener("click",function(e){s(e,n,"select-by-seen",t)}),e.addEventListener("keypress",function(e){s(e,n,"select-by-seen",t)})}),document.querySelectorAll(".course-select .select-by-format label").forEach(function(e){var n="INPUT"!==e.nodeName?e.querySelector('input[type="checkbox"]'):e,t=function(e){return!e};e.addEventListener("click",function(e){s(e,n,"select-by-format",t)}),e.addEventListener("keypress",function(e){s(e,n,"select-by-format",t)})}),document.querySelectorAll(".download-btn").forEach(function(e){e.addEventListener("click",function(n){n.preventDefault(),i(n,e)}),e.addEventListener("keypress",function(n){n.preventDefault(),i(n,e)})}),document.querySelectorAll(".download-all-btn").forEach(function(e){var n=function(e){e.preventDefault(),i(e,Array.from(document.querySelectorAll(".download-btn:enabled")))};e.addEventListener("click",n),e.addEventListener("keypress",n)})})},0)}]);